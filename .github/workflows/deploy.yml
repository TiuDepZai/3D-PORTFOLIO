name: Run Development Server

on:
  push:
    branches:
      - main

jobs:
  dev:
    runs-on: self-hosted

    steps:
      - name: Checkout Code
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Install Dependencies
        run: npm install

      - name: Display Public IP Address
        run: |
          echo "Fetching public IP address..."
          PUBLIC_IP=$(curl -s ifconfig.me)
          echo "Public IP Address: $PUBLIC_IP"

      - name: Display Internal IP Address
        run: |
          echo "Fetching internal IP address..."
          INTERNAL_IP=$(hostname -I | awk '{print $1}')
          echo "Internal IP Address: $INTERNAL_IP"

      - name: Run Vite Dev Server in Background
        run: |
          nohup npm run dev &> dev.log &

      - name: Notify Success
        run: echo "Development server is running in the background."
